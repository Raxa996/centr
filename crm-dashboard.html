<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <base href="/centr/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CRM —Å–∏—Å—Ç–µ–º–∞ - –¶–µ–Ω—Ç—Ä "–†–∞–¥—É–≥–∞"</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
      window.PUBLIC_SUPABASE_URL = "https://estplmvqprqbobrjicmd.supabase.co";
      window.PUBLIC_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVzdHBsbXZxcHJxYm9icmppY21kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwMzQxNTUsImV4cCI6MjA3NjYxMDE1NX0.dZrGpi9mJ_oZqVn0LlzVqzOQMLSH097DT2jlOGuArpc";
    </script>
    <script src="supabaseClient.js"></script>
    <script src="script.js"></script>
    <style>
        .crm-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
            margin-bottom: 2rem;
        }
        
        .role-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-left: 1rem;
        }
        
        .role-owner {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
        }
        
        .role-admin {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            text-align: center;
            border-left: 5px solid;
        }
        
        .stat-card.revenue { border-left-color: #27ae60; }
        .stat-card.clients { border-left-color: #3498db; }
        .stat-card.bookings { border-left-color: #e74c3c; }
        .stat-card.staff { border-left-color: #f39c12; }
        
        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: #000000;
        }
        
        .stat-label {
            color: #666;
            font-weight: 500;
        }
        
        .crm-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
            background: white;
            padding: 1.5rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .crm-tabs button {
            aspect-ratio: 1;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 1rem;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
            line-height: 1.2;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
        }
        
        .crm-tabs button i {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .crm-tabs button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .crm-tabs button.btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .crm-tabs button.btn-secondary {
            background: #f8f9fa !important;
            color: #333 !important;
            border: 2px solid #e9ecef !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .crm-tabs button.btn-secondary:hover {
            background: #667eea !important;
            color: white !important;
            border-color: #667eea !important;
        }
        
        .access-management {
            background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,237,78,0.1));
            border: 2px solid #ffd700;
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .access-management h3 {
            color: #b8860b;
            margin-bottom: 1rem;
        }
        
        .user-list {
            display: grid;
            gap: 1rem;
        }
        
        .user-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .user-info h4 {
            margin: 0 0 0.25rem 0;
            color: #333;
        }
        
        .user-info p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }
        
        .user-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .client-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .client-card h4 {
            margin: 0 0 0.5rem 0;
            color: #333;
            font-weight: 700;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.08);
        }
        
        .client-card p {
            margin: 0.25rem 0;
            color: #666;
        }
        
        .clients-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            max-width: 100%;
            overflow-x: hidden;
        }
        
        .clients-table-container {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow-x: auto;
        }
        
        .clients-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .clients-table th,
        .clients-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
            white-space: nowrap;
        }
        
        .clients-table th {
            background: #f8f9fa;
            font-weight: 700;
            color: #333;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .clients-table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .clients-table .client-name {
            font-weight: 600;
            color: #333;
        }
        
        .clients-table .phone-number {
            color: #667eea;
            font-weight: 500;
        }
        
        .clients-table .amount {
            font-weight: 700;
            color: #28a745;
        }
        
        .clients-table .action-buttons {
            display: flex;
            gap: 0.5rem;
            align-items: center;
        }
        
        .clients-table .btn-action {
            background: none;
            border: none;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
        }
        
        .clients-table .btn-action.view {
            background: #007bff;
            color: white;
        }
        
        .clients-table .btn-action.view:hover {
            background: #0056b3;
        }
        
        .clients-table .btn-action.message {
            background: #e83e8c;
            color: white;
        }
        
        .clients-table .btn-action.message:hover {
            background: #c62d6b;
        }
        
        .client-details {
            max-height: 70vh;
            overflow-y: auto;
        }
        
        .detail-section {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .detail-section h3 {
            margin: 0 0 1rem 0;
            color: #333;
            font-size: 1.1rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        .child-info {
            background: white;
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-radius: 6px;
            border-left: 3px solid #667eea;
        }
        
        .purchases-table {
            overflow-x: auto;
        }
        
        /* –ü—Ä–æ—Å—Ç–æ–π –∏ —á–∏—Å—Ç—ã–π –¥–∏–∑–∞–π–Ω */
        .simple-section {
            background: white;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin: 0 auto 2rem auto;
            max-width: 1200px;
        }
        
        .simple-section h1 {
            font-size: 1.8rem;
            font-weight: 600;
            color: #333;
            margin: 0 0 2rem 0;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 1rem;
        }
        
        .clients-table-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: none;
            border: 1px solid #e0e0e0;
            width: 100%;
            max-width: 100%;
            overflow-x: auto;
        }
        
        .clients-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 600px;
            max-width: 100%;
        }
        
        .clients-table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #666;
            font-size: 0.9rem;
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .clients-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
            color: #333;
        }
        
        .clients-table tbody tr:hover {
            background-color: #f8f9fa;
        }
        
        .clients-table .client-name {
            font-weight: 500;
            color: #333;
        }
        
        .clients-table .phone-number {
            color: #666;
            font-size: 0.9rem;
        }
        
        .clients-table .amount {
            font-weight: 600;
            color: #333;
            font-size: 1rem;
        }
        
        .clients-table .action-buttons {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            justify-content: center;
        }
        
        .clients-table .btn-action {
            background: #007bff;
            border: none;
            padding: 0.5rem;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 32px;
            height: 32px;
            color: white;
        }
        
        .clients-table .btn-action:hover {
            background: #0056b3;
            transform: translateY(-1px);
        }
        
        /* –û—Ç—Å—Ç—É–ø—ã –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –≤ —Ä–∞–∑–¥–µ–ª–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ */
        #clientsTab.active ~ * .container,
        #clientsTab.active .container {
            border-top-width: 30px;
            padding-top: 40px;
        }
        
        .records-table {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .records-table table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .records-table th,
        .records-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid #eee;
        }
        
        .records-table th {
            background: #f8f9fa;
            font-weight: 700;
            color: #333;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
        }
        
        .status-confirmed {
            color: #27ae60;
            font-weight: 600;
        }
        
        .status-pending {
            color: #f39c12;
            font-weight: 600;
        }
        
        .recent-activities {
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .recent-activities h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        .activity-item {
            display: flex;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid #eee;
        }
        
        .activity-item:last-child {
            border-bottom: none;
        }
        
        .activity-icon {
            margin-right: 1rem;
            color: #667eea;
        }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-content p {
            margin: 0 0 0.25rem 0;
            color: #333;
        }
        
        .activity-time {
            font-size: 0.9rem;
            color: #666;
        }
        
        .dashboard-section {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .dashboard-section h2 {
            font-weight: 700;
            color: #333;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
            letter-spacing: -0.02em;
            line-height: 1.2;
            margin-bottom: 1.5rem;
        }
        
        .analytics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }
        
        .analytics-card {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .analytics-card h4 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #f0f0f0;
            padding-bottom: 0.5rem;
            font-weight: 700;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.1);
        }
        
        .finance-summary {
            margin-bottom: 2rem;
        }
        
        .finance-card.main {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-align: center;
            padding: 2rem;
            border-radius: 15px;
            margin-bottom: 1rem;
        }
        
        .revenue-amount {
            font-size: 2.5rem;
            font-weight: 700;
            margin: 1rem 0;
        }
        
        .service-row {
            display: flex;
            justify-content: space-between;
            padding: 0.75rem;
            border-bottom: 1px solid #eee;
            align-items: center;
        }
        
        .service-name {
            font-weight: 600;
            color: #333;
        }
        
        .service-amount {
            font-weight: 700;
            color: #27ae60;
        }
        
        .services-list {
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .schedule-list {
            display: grid;
            gap: 1.5rem;
        }
        
        .schedule-day {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .schedule-day h4 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }
        
        .appointment-item {
            display: flex;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 8px;
            border-left: 4px solid;
        }
        
        .appointment-item.confirmed {
            background: #f8fff8;
            border-left-color: #27ae60;
        }
        
        .appointment-item.pending {
            background: #fff9f0;
            border-left-color: #f39c12;
        }
        
        .appointment-time {
            font-weight: 700;
            min-width: 80px;
            color: #667eea;
        }
        
        .appointment-details {
            flex: 1;
            margin-left: 1rem;
        }
        
        .status-badge {
            float: right;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-badge.confirmed {
            background: #d4edda;
            color: #155724;
        }
        
        .status-badge.pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .messages-center {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .message-stats, .quick-message {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .quick-message-form .form-group {
            margin-bottom: 1rem;
        }
        
        .quick-message-form label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: #333;
        }
        
        .quick-message-form input,
        .quick-message-form textarea {
            width: 100%;
            padding: 0.75rem;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 1rem;
        }
        
        .quick-message-form input:focus,
        .quick-message-form textarea:focus {
            outline: none;
            border-color: #667eea;
        }
        
        /* –ê–¥–º–∏–Ω—Å–∫–∏–µ —Å—Ç–∏–ª–∏ */
        .admin-form {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
            margin-bottom: 1rem;
        }
        
        .booking-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 1rem;
            border-radius: 10px;
            margin-bottom: 1rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .booking-actions {
            display: flex;
            gap: 0.5rem;
        }
        
        .btn-success {
            background: #27ae60 !important;
            color: white !important;
            border: none !important;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            box-shadow: 0 2px 4px rgba(39, 174, 96, 0.3);
            transition: all 0.3s ease;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .btn-success:hover {
            background: #229954 !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.4);
        }
        
        .btn-danger {
            background: #e74c3c !important;
            color: white !important;
            border: none !important;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            box-shadow: 0 2px 4px rgba(231, 76, 60, 0.3);
            transition: all 0.3s ease;
            opacity: 1 !important;
            visibility: visible !important;
        }
        
        .btn-danger:hover {
            background: #c0392b !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(231, 76, 60, 0.4);
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
        }
        
        .calendar-day {
            background: white;
            padding: 1rem;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .appointment-badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            margin: 0.25rem;
            border-radius: 15px;
            font-size: 0.8rem;
        }
        
        .appointment-badge.confirmed {
            background: #d4edda;
            color: #155724;
        }
        
        .appointment-badge.pending {
            background: #fff3cd;
            color: #856404;
        }
        
        .lessons-stats, .report-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-item, .report-item {
            background: white;
            padding: 1.5rem;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .whatsapp-center, .payment-center {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
        }
        
        .daily-report .report-header {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .report-actions {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }
        
        .permissions-section {
            margin: 1.5rem 0;
        }
        
        .permissions-list {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }
        
        .permission-item {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            background: #f8f9fa;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .permission-item:hover {
            background: #e9ecef;
        }
        
        .permission-item input[type="checkbox"] {
            margin-right: 0.75rem;
            transform: scale(1.2);
        }
        
        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 2rem;
        }
        
        /* –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑ –±–æ–∫–æ–≤–æ–π –ø–∞–Ω–µ–ª–∏ */
        .main-content-wrapper {
            display: block;
            margin-top: 2rem;
        }
        
        .crm-content-main {
            width: 100%;
        }
        
        .access-management-sidebar {
            background: linear-gradient(135deg, rgba(255,215,0,0.1), rgba(255,237,78,0.1));
            border: 2px solid #ffd700;
            border-radius: 15px;
            padding: 1.5rem;
            height: fit-content;
            position: sticky;
            top: 2rem;
        }
        
        .access-management-sidebar h3 {
            color: #b8860b;
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }
        
        /* –°–∫—Ä—ã–≤–∞–µ–º –¥–ª—è –Ω–µ-–≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ */
        .access-management-sidebar.hidden {
            display: none;
        }
        
        /* –í—Å–µ —Å–µ–∫—Ü–∏–∏ —Å–∫—Ä—ã—Ç—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é */
        .crm-section {
            display: none;
        }
        
        .crm-section.active {
            display: block;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ */
        .staff-management {
            padding: 1rem;
        }
        
        .management-actions {
            margin-bottom: 2rem;
            text-align: right;
        }
        
        .staff-list h4 {
            margin-bottom: 1rem;
            color: #333;
        }
        
        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }
        
        .staff-card {
            background: white;
            border-radius: 10px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }
        
        .staff-info h4 {
            margin-top: 0;
            color: #333;
            font-weight: 700;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.08);
            font-size: 1.2rem;
        }
        
        .staff-info p {
            margin: 0.5rem 0;
            color: #666;
            font-weight: 500;
            line-height: 1.5;
        }
        
        .status-active {
            color: #27ae60;
            font-weight: 600;
        }
        
        .staff-actions {
            margin-top: 1rem;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .staff-actions .btn-secondary {
            background: #667eea !important;
            color: white !important;
            border: none !important;
            opacity: 1 !important;
            visibility: visible !important;
            font-weight: 600;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.2);
            box-shadow: 0 2px 4px rgba(102, 126, 234, 0.3);
        }
        
        .staff-actions .btn-secondary:hover {
            background: #5a6fd8 !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(102, 126, 234, 0.4);
        }
        
        .staff-actions .btn-danger {
            background: #e74c3c !important;
            color: white !important;
            border: none !important;
            opacity: 1 !important;
            visibility: visible !important;
        }
    </style>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>üåà –¶–µ–Ω—Ç—Ä "–†–∞–¥—É–≥–∞" - CRM</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                </li>
                <li class="nav-item">
                    <span class="nav-link" id="userName">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                    <span id="userRole" class="role-badge">–†–æ–ª—å</span>
                </li>
                <li class="nav-item">
                    <button class="btn-secondary" onclick="logout()">–í—ã–π—Ç–∏</button>
                </li>
            </ul>
        </div>
    </nav>

    <div class="dashboard">
        <div class="dashboard-layout">
            <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
            <div class="sidebar">
                <div class="sidebar-menu" id="crmSidebar">
                    <!-- –≠–ª–µ–º–µ–Ω—Ç—ã –º–µ–Ω—é –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
        </div>
    </div>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="main-content">
        <div class="container">

                    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="main-content-wrapper">
                <!-- –ö–æ–Ω—Ç–µ–Ω—Ç CRM -->
                <div id="crmContent" class="crm-content-main">
                <!-- –î–∞—à–±–æ—Ä–¥ -->
                <div id="dashboardTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã</h2>
                        <div class="recent-activities">
                            <h3>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—è</h3>
                            <div id="recentActivities">
                                <!-- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –ö–ª–∏–µ–Ω—Ç—ã -->
                <div id="clientsTab" class="crm-section">
                    <div class="simple-section">
                        <h1>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏</h1>
                        <div class="clients-table-container">
                            <table class="clients-table" id="clientsTable">
                                <thead>
                                    <tr>
                                        <th>–ö–ª–∏–µ–Ω—Ç</th>
                                        <th>–¢–µ–ª–µ—Ñ–æ–Ω</th>
                                        <th>–ü–æ—Å–ª–µ–¥–Ω—è—è –æ–ø–µ—Ä–∞—Ü–∏—è</th>
                                        <th>–°—É–º–º–∞</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                </thead>
                                <tbody id="clientsTableBody">
                                    <!-- –î–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- –ó–∞–ø–∏—Å–∏ -->
                <div id="bookingsTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏</h2>
                        <div class="records-table" id="recordsTable">
                            <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–ø–∏—Å–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>

                <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ -->
                <div id="scheduleTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π</h2>
                        <div id="scheduleContent">
                            <!-- –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–æ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>

                <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
                <div id="messagesTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–¶–µ–Ω—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π</h2>
                        <div id="messagesContent">
                            <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>

                <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ -->
                <div id="analyticsTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</h2>
                        <div id="analyticsContent">
                            <!-- –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>

                <!-- –§–∏–Ω–∞–Ω—Å—ã -->
                <div id="financeTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å</h2>
                        <div id="financeContent">
                            <!-- –§–∏–Ω–∞–Ω—Å—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                        </div>
                    </div>
                </div>

                <!-- –ê–¥–º–∏–Ω—Å–∫–∏–µ —Å–µ–∫—Ü–∏–∏ -->
                <!-- –ó–∞–ø–∏—Å—å —Ä–µ–±–µ–Ω–∫–∞ -->
                <div id="childBookingTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–ó–∞–ø–∏—Å—å —Ä–µ–±–µ–Ω–∫–∞</h2>
                        <div id="childBookingContent">
                            <!-- –§–æ—Ä–º–∞ –∑–∞–ø–∏—Å–∏ —Ä–µ–±–µ–Ω–∫–∞ -->
                        </div>
                    </div>
                </div>

                <!-- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ -->
                <div id="confirmBookingTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π</h2>
                        <div id="confirmBookingContent">
                            <!-- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π -->
                        </div>
                    </div>
                </div>

                <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–∏ -->
                <div id="bookingCalendarTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–∏</h2>
                        <div id="bookingCalendarContent">
                            <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–∏ -->
                        </div>
                    </div>
                </div>

                <!-- –£—Ä–æ–∫–∏ -->
                <div id="lessonsTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–£—Ä–æ–∫–∏</h2>
                        <div id="lessonsContent">
                            <!-- –£—Ä–æ–∫–∏ -->
                        </div>
                    </div>
                </div>

                <!-- –†–∞—Å—Å—ã–ª–∫–∞ –≤ WhatsApp -->
                <div id="whatsappTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–†–∞—Å—Å—ã–ª–∫–∞ —Ä–æ–¥–∏—Ç–µ–ª—è–º</h2>
                        <div id="whatsappContent">
                            <!-- –†–∞—Å—Å—ã–ª–∫–∞ –≤ WhatsApp -->
                        </div>
                    </div>
                </div>

                <!-- –ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã -->
                <div id="paymentTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã</h2>
                        <div id="paymentContent">
                            <!-- –ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã -->
                        </div>
                    </div>
                </div>

                <!-- –û—Ç—á–µ—Ç –ø–æ –¥–µ–Ω—å–≥–∞–º –∑–∞ —Å–µ–≥–æ–¥–Ω—è -->
                <div id="dailyReportTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–û—Ç—á–µ—Ç –∑–∞ —Å–µ–≥–æ–¥–Ω—è</h2>
                        <div id="dailyReportContent">
                            <!-- –û—Ç—á–µ—Ç –ø–æ –¥–µ–Ω—å–≥–∞–º –∑–∞ —Å–µ–≥–æ–¥–Ω—è -->
                        </div>
                    </div>
                </div>

                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ -->
                <div id="staffManagementTab" class="crm-section">
                    <div class="dashboard-section">
                        <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</h2>
                        <div id="staffManagementContent">
                            <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏ -->
                        </div>
                    </div>
                </div>
                
                <!-- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞–º–∏ (—Å–∫—Ä—ã—Ç–æ, —Ç–∞–∫ –∫–∞–∫ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω—É—é –Ω–∞–≤–∏–≥–∞—Ü–∏—é) -->
                <div id="accessManagement" class="access-management-sidebar" style="display: none !important;">
                    <!-- <h3><i class="fas fa-users-cog"></i> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞–º–∏</h3>
                    <div class="user-list" id="userList">
                        –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω –∑–¥–µ—Å—å
                    </div>
                    <button class="btn-primary" onclick="openAddUserModal()">
                        <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                    </button> -->
                </div>
                </div>
                </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addUserModal')">&times;</span>
            <h2>–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>
            <form id="addUserForm">
                <div class="form-group">
                    <label for="newUserType">–¢–∏–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <select id="newUserType" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø</option>
                        <option value="admin">–°–æ—Ç—Ä—É–¥–Ω–∏–∫</option>
                        <option value="owner">–í–ª–∞–¥–µ–ª–µ—Ü</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="newUserName">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="newUserName" required>
                </div>
                <div class="form-group">
                    <label for="newUserLogin">–õ–æ–≥–∏–Ω</label>
                    <input type="text" id="newUserLogin" required>
                </div>
                <div class="form-group">
                    <label for="newUserPassword">–ü–∞—Ä–æ–ª—å</label>
                    <input type="password" id="newUserPassword" required>
                </div>
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div id="editUserModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal('editUserModal')">&times;</span>
            <h2>–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞</h2>
            <form id="editUserForm">
                <div class="form-group">
                    <label for="editUserLogin">–õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label>
                    <input type="text" id="editUserLogin" readonly>
                </div>
                
                <div class="permissions-section">
                    <h4>–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞:</h4>
                    <div class="permissions-list">
                        <label class="permission-item">
                            <input type="checkbox" id="perm_childBooking">
                            –ó–∞–ø–∏—Å—å —Ä–µ–±–µ–Ω–∫–∞
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="perm_confirmBooking">
                            –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="perm_bookingCalendar">
                            –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–∏
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="perm_lessons">
                            –£—Ä–æ–∫–∏
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="perm_whatsapp">
                            –†–∞—Å—Å—ã–ª–∫–∞ –≤ WhatsApp
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="perm_payment">
                            –ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã
                        </label>
                        <label class="permission-item">
                            <input type="checkbox" id="perm_dailyReport">
                            –û—Ç—á–µ—Ç –ø–æ –¥–µ–Ω—å–≥–∞–º –∑–∞ —Å–µ–≥–æ–¥–Ω—è
                        </label>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-primary" onclick="saveUserPermissions()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–∞–≤–∞</button>
                    <button type="button" class="btn-secondary" onclick="closeModal('editUserModal')">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentUser = null;

        document.addEventListener('DOMContentLoaded', () => {
            currentUser = JSON.parse(localStorage.getItem('currentUser'));

            if (!currentUser || (currentUser.type !== 'admin' && currentUser.type !== 'owner')) {
                window.location.href = 'index.html';
                return;
            }

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            const userNameElement = document.getElementById('userName');
            const userRoleElement = document.getElementById('userRole');
            
            if (currentUser.displayName) {
                userNameElement.textContent = `${currentUser.displayName} (${currentUser.name})`;
            } else {
                userNameElement.textContent = currentUser.name || '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å';
            }

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–æ–ª—å –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            const isOwner = currentUser.role === 'owner' || currentUser.type === 'owner';
            
            if (isOwner) {
                userRoleElement.textContent = '–í–ª–∞–¥–µ–ª–µ—Ü';
                userRoleElement.className = 'role-badge role-owner';
            } else {
                userRoleElement.textContent = '–°–æ—Ç—Ä—É–¥–Ω–∏–∫';
                userRoleElement.className = 'role-badge role-admin';
            }

            // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å—Ç–∏–ª–∏
            userNameElement.style.color = '#ffd700';
            userNameElement.style.fontWeight = 'bold';
            userNameElement.style.textShadow = '1px 1px 2px rgba(0,0,0,0.5)';

            // –°–æ–∑–¥–∞–µ–º –Ω–∞–≤–∏–≥–∞—Ü–∏—é –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–æ–ª–∏
            createNavigationForRole(currentUser);

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞—à–±–æ—Ä–¥
            initializeDemoData();
            setTimeout(() => {
                loadCrmDashboard();
            }, 100);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('addUserForm')?.addEventListener('submit', handleAddUser);
        });

        function createNavigationForRole(user) {
            const crmSidebar = document.getElementById('crmSidebar');
            const isOwner = user.role === 'owner' || user.type === 'owner';
            
            if (isOwner) {
                // –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ - –≤—Å–µ 13 —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ —Å–ø–∏—Å–∫–∞
                crmSidebar.innerHTML = `
                    <div class="menu-item active" onclick="showCrmTab('clients')">
                        <i class="fas fa-users"></i>
                        <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞–º–∏</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('bookings')">
                        <i class="fas fa-calendar-check"></i>
                        <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('schedule')">
                        <i class="fas fa-calendar-alt"></i>
                        <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('messages')">
                        <i class="fas fa-comments"></i>
                        <span>–¶–µ–Ω—Ç—Ä —Å–æ–æ–±—â–µ–Ω–∏–π</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('analytics')">
                        <i class="fas fa-chart-bar"></i>
                        <span>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('finance')">
                        <i class="fas fa-wallet"></i>
                        <span>–§–∏–Ω–∞–Ω—Å–æ–≤–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('childBooking')">
                        <i class="fas fa-user-plus"></i>
                        <span>–ó–∞–ø–∏—Å—å —Ä–µ–±–µ–Ω–∫–∞</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('confirmBooking')">
                        <i class="fas fa-check-circle"></i>
                        <span>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('bookingCalendar')">
                        <i class="fas fa-calendar"></i>
                        <span>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–∏</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('lessons')">
                        <i class="fas fa-graduation-cap"></i>
                        <span>–£—Ä–æ–∫–∏</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('whatsapp')">
                        <i class="fab fa-whatsapp"></i>
                        <span>–†–∞—Å—Å—ã–ª–∫–∞ —Ä–æ–¥–∏—Ç–µ–ª—è–º</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('payment')">
                        <i class="fas fa-credit-card"></i>
                        <span>–ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('dailyReport')">
                        <i class="fas fa-chart-line"></i>
                        <span>–û—Ç—á–µ—Ç –∑–∞ —Å–µ–≥–æ–¥–Ω—è</span>
                    </div>
                    <div class="menu-item" onclick="showCrmTab('staffManagement')">
                        <i class="fas fa-users-cog"></i>
                        <span>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏</span>
                    </div>
                `;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é –≤–∫–ª–∞–¥–∫—É –¥–ª—è –≤–ª–∞–¥–µ–ª—å—Ü–∞
                document.querySelectorAll('.crm-section').forEach(section => section.classList.remove('active'));
                document.getElementById('clientsTab').classList.add('active');
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–µ—Ä–≤–æ–π –≤–∫–ª–∞–¥–∫–∏
                setTimeout(() => loadClients(), 100);
            } else {
                // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∞–¥–º–∏–Ω–∞
                const permissions = getUserPermissions(user.login);
                
                // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–ª—è –∞–¥–º–∏–Ω–∞ —Å —É—á–µ—Ç–æ–º –µ–≥–æ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
                let adminMenuItems = '';
                let firstTab = '';
                
                const tabPermissions = [
                    { id: 'childBooking', icon: 'fas fa-user-plus', label: '–ó–∞–ø–∏—Å—å —Ä–µ–±–µ–Ω–∫–∞' },
                    { id: 'confirmBooking', icon: 'fas fa-check-circle', label: '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏' },
                    { id: 'bookingCalendar', icon: 'fas fa-calendar', label: '–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–∏' },
                    { id: 'lessons', icon: 'fas fa-graduation-cap', label: '–£—Ä–æ–∫–∏' },
                    { id: 'whatsapp', icon: 'fab fa-whatsapp', label: '–†–∞—Å—Å—ã–ª–∫–∞ WhatsApp' },
                    { id: 'payment', icon: 'fas fa-credit-card', label: '–ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã' },
                    { id: 'dailyReport', icon: 'fas fa-chart-line', label: '–û—Ç—á–µ—Ç –∑–∞ –¥–µ–Ω—å' }
                ];
                
                tabPermissions.forEach((tab, index) => {
                    if (permissions[tab.id]) {
                        const activeClass = adminMenuItems === '' ? 'active' : '';
                        adminMenuItems += `
                            <div class="menu-item ${activeClass}" onclick="showCrmTab('${tab.id}')">
                                <i class="${tab.icon}"></i>
                                <span>${tab.label}</span>
                            </div>
                        `;
                        
                        if (firstTab === '') {
                            firstTab = tab.id;
                        }
                    }
                });
                
                crmSidebar.innerHTML = adminMenuItems;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é –≤–∫–ª–∞–¥–∫—É –¥–ª—è –∞–¥–º–∏–Ω–∞
                document.querySelectorAll('.crm-section').forEach(section => section.classList.remove('active'));
                if (firstTab) {
                    document.getElementById(firstTab + 'Tab').classList.add('active');
                    setTimeout(() => {
                        const loadFunction = window['load' + firstTab.charAt(0).toUpperCase() + firstTab.slice(1)];
                        if (loadFunction) loadFunction();
                    }, 100);
                }
            }
        }

        function getUserPermissions(login) {
            // –ï—Å–ª–∏ —ç—Ç–æ –≤–ª–∞–¥–µ–ª–µ—Ü - –≤—Å–µ –ø—Ä–∞–≤–∞
            if (login === 'Raxa') {
                return {
                    'childBooking': true,
                    'confirmBooking': true,
                    'bookingCalendar': true,
                    'lessons': true,
                    'whatsapp': true,
                    'payment': true,
                    'dailyReport': true
                };
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∞–≤–∞ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤ –∏–∑ localStorage
            const customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
            const user = customUsers.find(u => u.login === login);
            
            if (user && user.permissions) {
                return user.permissions;
            }
            
            // –ü—Ä–∞–≤–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            return {
                'childBooking': true,
                'confirmBooking': true,
                'bookingCalendar': true,
                'lessons': true,
                'whatsapp': true,
                'payment': true,
                'dailyReport': true
            };
        }

        function initializeDemoData() {
            console.log('–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ...');
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å—ã (–¥–æ—Ö–æ–¥—ã)
            let requests = JSON.parse(localStorage.getItem('requests') || '[]');
            if (requests.length === 0) {
                requests = [
                    { amount: 25000, service: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ', parentName: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞', date: new Date().toISOString() },
                    { amount: 15000, service: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫', parentName: '–ï–ª–µ–Ω–∞ –ö–æ–∑–ª–æ–≤–∞', date: new Date().toISOString() },
                    { amount: 18000, service: '–¢–∞–Ω—Ü—ã', parentName: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞', date: new Date().toISOString() }
                ];
                localStorage.setItem('requests', JSON.stringify(requests));
                console.log('–î–µ–º–æ-–∑–∞–ø—Ä–æ—Å—ã —Å–æ–∑–¥–∞–Ω—ã:', requests);
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∑–∞–ø–∏—Å–∏
            let appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            if (appointments.length === 0) {
                appointments = [
                    { parentName: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞', childName: '–ú–∞—Ä–∏—è', service: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ', date: new Date().toISOString(), time: '10:00', status: 'confirmed' },
                    { parentName: '–ï–ª–µ–Ω–∞ –ö–æ–∑–ª–æ–≤–∞', childName: '–î–º–∏—Ç—Ä–∏–π', service: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π', date: new Date().toISOString(), time: '11:30', status: 'pending' },
                    { parentName: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞', childName: '–ê–Ω–Ω–∞', service: '–¢–∞–Ω—Ü—ã', date: new Date().toISOString(), time: '14:00', status: 'confirmed' }
                ];
                localStorage.setItem('appointments', JSON.stringify(appointments));
                console.log('–î–µ–º–æ-–∑–∞–ø–∏—Å–∏ —Å–æ–∑–¥–∞–Ω—ã:', appointments);
            }

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤
            let registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');
            if (Object.keys(registeredUsers).length === 0) {
                registeredUsers = {
                    '+77771234567': {
                        parentName: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞',
                        phone: '+7 777 123 45 67',
                        email: 'anna@example.com',
                        children: [{ name: '–ú–∞—Ä–∏—è', age: 5 }]
                    },
                    '+77771234568': {
                        parentName: '–ï–ª–µ–Ω–∞ –ö–æ–∑–ª–æ–≤–∞',
                        phone: '+7 777 123 45 68',
                        email: 'elena@example.com',
                        children: [{ name: '–î–º–∏—Ç—Ä–∏–π', age: 4 }]
                    },
                    '+77771234569': {
                        parentName: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞',
                        phone: '+7 777 123 45 69',
                        email: 'maria@example.com',
                        children: [{ name: '–ê–Ω–Ω–∞', age: 6 }]
                    }
                };
                localStorage.setItem('registeredUsers', JSON.stringify(registeredUsers));
                console.log('–î–µ–º–æ-–∫–ª–∏–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã:', registeredUsers);
            }
        }

        function showCrmTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            document.querySelectorAll('.crm-section').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—é
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            document.getElementById(tabName + 'Tab').classList.add('active');
            
            // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç –º–µ–Ω—é
            event.target.closest('.menu-item').classList.add('active');

            // –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Ä–∞–∑–¥–µ–ª–∞ –∫–ª–∏–µ–Ω—Ç–æ–≤
            const container = document.querySelector('.main-content .container');
            
            if (tabName === 'clients') {
                if (container) {
                    container.style.maxWidth = '1200px';
                    container.style.marginLeft = '0';
                    container.style.paddingLeft = '2rem';
                    container.style.borderTopWidth = '30px';
                    container.style.paddingTop = '40px';
                    container.classList.add('clients-active');
                }
            } else {
                if (container) {
                    container.style.maxWidth = '';
                    container.style.marginLeft = '';
                    container.style.paddingLeft = '';
                    container.style.borderTopWidth = '';
                    container.style.paddingTop = '';
                    container.classList.remove('clients-active');
                }
            }

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–∫–∏
            switch(tabName) {
                case 'dashboard':
                    loadDashboard();
                    break;
                case 'clients':
                    loadClients();
                    break;
                case 'bookings':
                    loadBookings();
                    break;
                case 'schedule':
                    loadSchedule();
                    break;
                case 'messages':
                    loadMessages();
                    break;
                case 'analytics':
                    loadAnalytics();
                    break;
                case 'finance':
                    loadFinance();
                    break;
                case 'childBooking':
                    loadChildBooking();
                    break;
                case 'confirmBooking':
                    loadConfirmBooking();
                    break;
                case 'bookingCalendar':
                    loadBookingCalendar();
                    break;
                case 'lessons':
                    loadLessons();
                    break;
                case 'whatsapp':
                    loadWhatsApp();
                    break;
                case 'payment':
                    loadPayment();
                    break;
                case 'dailyReport':
                    loadDailyReport();
                    break;
                case 'staffManagement':
                    loadStaffManagement();
                    break;
            }
        }

        function loadCrmDashboard() {
            console.log('–ó–∞–≥—Ä—É–∂–∞–µ–º CRM –¥–∞—à–±–æ—Ä–¥...');
            try {
                loadDashboard();
                console.log('CRM –¥–∞—à–±–æ—Ä–¥ –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ CRM –¥–∞—à–±–æ—Ä–¥–∞:', error);
            }
        }

        function loadDashboard() {
            const activities = [
                { action: '–ù–æ–≤–∞—è –∑–∞–ø–∏—Å—å', time: '10:30', client: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞' },
                { action: '–û–ø–ª–∞—Ç–∞ –ø–æ—Å—Ç—É–ø–∏–ª–∞', time: '09:15', amount: '15000' },
                { action: '–û—Ç–º–µ–Ω–∞ –∑–∞–Ω—è—Ç–∏—è', time: '08:45', client: '–ï–ª–µ–Ω–∞ –ö–æ–∑–ª–æ–≤–∞' },
                { action: '–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç', time: '08:00', client: '–ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–∞' }
            ];

            const activitiesHtml = activities.map(activity => `
                <div class="activity-item">
                    <div class="activity-icon">
                        <i class="fas fa-circle"></i>
                    </div>
                    <div class="activity-content">
                        <p><strong>${activity.action}</strong> 
                        ${activity.client ? '- ' + activity.client : ''}
                        ${activity.amount ? '- ' + activity.amount + '‚Ç∏' : ''}</p>
                        <span class="activity-time">${activity.time}</span>
                    </div>
                </div>
            `).join('');

            document.getElementById('recentActivities').innerHTML = activitiesHtml;
        }


        function loadUserAccess() {
            if (currentUser.role !== 'owner' && currentUser.type !== 'owner') return;

            // –ë–∞–∑–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
            const baseUsers = [
                { name: 'Raxa (–í–ª–∞–¥–µ–ª–µ—Ü)', login: 'Raxa', role: 'owner', status: 'active' },
                { name: 'Admin1 (–°–æ—Ç—Ä—É–¥–Ω–∏–∫)', login: 'Admin1', role: 'admin', status: 'active' }
            ];

            // –ü–æ–ª—É—á–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ localStorage
            const customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
            const customUsersFormatted = customUsers.map(user => ({
                name: `${user.name} (${user.role === 'owner' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : '–°–æ—Ç—Ä—É–¥–Ω–∏–∫'})`,
                login: user.login,
                role: user.role,
                status: 'active',
                isCustom: true
            }));

            // –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const allUsers = [...baseUsers, ...customUsersFormatted];

            const userListHtml = allUsers.map(user => `
                <div class="user-item">
                    <div class="user-info">
                        <h4>${user.name}</h4>
                        <p>–õ–æ–≥–∏–Ω: ${user.login} ‚Ä¢ –†–æ–ª—å: ${user.role === 'owner' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : '–°–æ—Ç—Ä—É–¥–Ω–∏–∫'}</p>
                    </div>
                    <div class="user-actions">
                        <button class="btn-secondary" onclick="editUser('${user.login}')">
                            <i class="fas fa-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å
                        </button>
                        <button class="btn-secondary" onclick="deleteUser('${user.login}')">
                            <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                        </button>
                    </div>
                </div>
            `).join('');

            document.getElementById('userList').innerHTML = userListHtml;
        }

        async function loadClients() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–æ–¥–∏—Ç–µ–ª–µ–π –∏–∑ –ë–î
                const { data: parents, error: parentsError } = await supa
                    .from("users")
                    .select(`
                        id, full_name, phone,
                        children(id, full_name, birthdate),
                        invoices(id, amount, due_date, status),
                        payments(id, amount, paid_at)
                    `)
                    .eq("role_id", "parent");

                if (parentsError) {
                    console.error('Error loading parents:', parentsError);
                    // Fallback –Ω–∞ localStorage –µ—Å–ª–∏ –ë–î –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞
                    let clients = JSON.parse(localStorage.getItem('clientsData') || '[]');
                    if (clients.length === 0) {
                        clients = getDemoClients();
                        localStorage.setItem('clientsData', JSON.stringify(clients));
                    }
                    renderClientsTable(clients);
                    return;
                }

                // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–∞–Ω–Ω—ã–µ —Ä–æ–¥–∏—Ç–µ–ª–µ–π –≤ —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
                const clients = await Promise.all(parents.map(async (parent) => {
                    // –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –æ–ø–µ—Ä–∞—Ü–∏—é –∏–∑ –∑–∞–ø–∏—Å–µ–π
                    const { data: bookings } = await supa
                        .from("bookings")
                        .select("created_at")
                        .eq("child_id", parent.children?.[0]?.id || "")
                        .order("created_at", { ascending: false })
                        .limit(1);

                    const totalAmount = parent.invoices?.reduce((sum, inv) => sum + Number(inv.amount || 0), 0) || 0;
                    const lastOperation = bookings?.[0]?.created_at ? 
                        new Date(bookings[0].created_at).toLocaleDateString('ru-RU') : '–ù–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏–π';

                    return {
                        id: parent.id,
                        name: parent.full_name || '',
                        phone: parent.phone || '',
                        lastOperation: lastOperation,
                        totalAmount: totalAmount,
                        children: parent.children || [],
                        invoices: parent.invoices || [],
                        payments: parent.payments || []
                    };
                }));

                renderClientsTable(clients);

            } catch (error) {
                console.error('Error in loadClients:', error);
                // Fallback –Ω–∞ –¥–µ–º–æ –¥–∞–Ω–Ω—ã–µ
                const clients = getDemoClients();
                renderClientsTable(clients);
            }
        }

        function getDemoClients() {
            return [
                {
                    id: 1,
                    name: '–ú–∞–ª–∏–∫–∞',
                    phone: '+77015557752',
                    lastOperation: '21/10/2025',
                    totalAmount: 59990,
                    children: [
                        { name: '–ê–π—à–∞', age: 7 },
                        { name: '–î–∞–Ω–∏—è—Ä', age: 5 }
                    ],
                    purchases: [
                        { date: '21/10/2025', service: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ', amount: 59990 }
                    ],
                    classes: ['–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞', '–ü–∏—Å—å–º–æ']
                }
                // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–µ–º–æ –∫–ª–∏–µ–Ω—Ç—ã –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
            ];
        }

        function renderClientsTable(clients) {
            const clientsTableBody = document.getElementById('clientsTableBody');
            if (clientsTableBody) {
                const clientsHtml = clients.map(client => `
                    <tr>
                        <td class="client-name">${client.name || ''}</td>
                        <td class="phone-number">${client.phone}</td>
                        <td>${client.lastOperation}</td>
                        <td class="amount">${client.totalAmount.toLocaleString()}‚Ç∏</td>
                        <td class="action-buttons">
                            <button class="btn-action view" onclick="showClientDetails('${client.id}')" title="–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è">
                                <i class="fas fa-external-link-alt"></i>
                            </button>
                        </td>
                    </tr>
            `).join('');

                clientsTableBody.innerHTML = clientsHtml || '<tr><td colspan="5" style="text-align: center; padding: 2rem;">–ö–ª–∏–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</td></tr>';
            }
        }

        function showClientDetails(clientId) {
            const clients = JSON.parse(localStorage.getItem('clientsData') || '[]');
            const client = clients.find(c => c.id === clientId);
            
            if (!client) {
                alert('–ö–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }

            // –°–æ–∑–¥–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π
            const modalHtml = `
                <div id="clientDetailsModal" class="modal" style="display: block;">
                    <div class="modal-content" style="max-width: 800px;">
                        <span class="close" onclick="closeModal('clientDetailsModal')">&times;</span>
                        <h2>–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–ª–∏–µ–Ω—Ç–µ</h2>
                        
                        <div class="client-details">
                            <div class="detail-section">
                                <h3>–û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h3>
                                <p><strong>–ò–º—è:</strong> ${client.name || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                                <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> ${client.phone}</p>
                                <p><strong>–ü–æ–ª:</strong> ${client.gender || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                                <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> ${client.age || '–ù–µ —É–∫–∞–∑–∞–Ω'}</p>
                            </div>
                            
                            <div class="detail-section">
                                <h3>–î–µ—Ç–∏ (${client.children.length})</h3>
                                ${client.children.map(child => `
                                    <div class="child-info">
                                        <p><strong>–ò–º—è:</strong> ${child.name}</p>
                                        <p><strong>–í–æ–∑—Ä–∞—Å—Ç:</strong> ${child.age} –ª–µ—Ç</p>
                                    </div>
                                `).join('')}
                            </div>
                            
                            <div class="detail-section">
                                <h3>–ó–∞–Ω—è—Ç–∏—è</h3>
                                ${client.classes.length > 0 ? 
                                    `<ul>${client.classes.map(cls => `<li>${cls}</li>`).join('')}</ul>` : 
                                    '<p>–ó–∞–Ω—è—Ç–∏—è –Ω–µ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã</p>'
                                }
                            </div>
                            
                            <div class="detail-section">
                                <h3>–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫ (${client.purchases.length})</h3>
                                <div class="purchases-table">
                                    <table style="width: 100%; border-collapse: collapse;">
                                        <thead>
                                            <tr style="background: #f8f9fa;">
                                                <th style="padding: 0.5rem; border: 1px solid #ddd;">–î–∞—Ç–∞</th>
                                                <th style="padding: 0.5rem; border: 1px solid #ddd;">–£—Å–ª—É–≥–∞</th>
                                                <th style="padding: 0.5rem; border: 1px solid #ddd;">–°—É–º–º–∞</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            ${client.purchases.map(purchase => `
                                                <tr>
                                                    <td style="padding: 0.5rem; border: 1px solid #ddd;">${purchase.date}</td>
                                                    <td style="padding: 0.5rem; border: 1px solid #ddd;">${purchase.service}</td>
                                                    <td style="padding: 0.5rem; border: 1px solid #ddd; font-weight: bold; color: #28a745;">${purchase.amount.toLocaleString()}‚Ç∏</td>
                                                </tr>
                                            `).join('')}
                                        </tbody>
                                    </table>
                                </div>
                                <div class="total-amount" style="margin-top: 1rem; text-align: right;">
                                    <strong>–û–±—â–∞—è —Å—É–º–º–∞: ${client.totalAmount.toLocaleString()}‚Ç∏</strong>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // –î–æ–±–∞–≤–ª—è–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤ DOM
            const existingModal = document.getElementById('clientDetailsModal');
            if (existingModal) {
                existingModal.remove();
            }
            
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function messageClient(clientId) {
            const clients = JSON.parse(localStorage.getItem('clientsData') || '[]');
            const client = clients.find(c => c.id === clientId);
            
            if (!client) {
                alert('–ö–ª–∏–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }

            const message = prompt(`–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—É ${client.name || client.phone}:`);
            if (message && message.trim()) {
                alert(`–°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –∫–ª–∏–µ–Ω—Ç—É ${client.phone}: "${message}"`);
                // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ API
            }
        }

        function loadBookings() {
            let appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            
            // –ï—Å–ª–∏ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ
            if (appointments.length === 0) {
                appointments = [
                    { parentName: '–ê–Ω–Ω–∞ –ü–µ—Ç—Ä–æ–≤–∞', childName: '–ú–∞—Ä–∏—è', service: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ', date: new Date().toISOString(), time: '10:00', status: 'confirmed' },
                    { parentName: '–ï–ª–µ–Ω–∞ –ö–æ–∑–ª–æ–≤–∞', childName: '–î–º–∏—Ç—Ä–∏–π', service: '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π', date: new Date().toISOString(), time: '11:30', status: 'pending' }
                ];
                localStorage.setItem('appointments', JSON.stringify(appointments));
            }

            const bookingsHtml = appointments.map(appointment => `
                <tr>
                    <td>${appointment.parentName || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td>${appointment.childName || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td>${appointment.service || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td>${new Date(appointment.date).toLocaleDateString('ru-RU')}</td>
                    <td>${appointment.time || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</td>
                    <td><span class="status-${appointment.status || 'pending'}">${appointment.status || '–û–∂–∏–¥–∞–µ—Ç'}</span></td>
                </tr>
            `).join('');

            const recordsTable = document.getElementById('recordsTable');
            if (recordsTable) {
                recordsTable.innerHTML = `
                    <table>
                        <thead>
                            <tr>
                                <th>–†–æ–¥–∏—Ç–µ–ª—å</th>
                                <th>–†–µ–±–µ–Ω–æ–∫</th>
                                <th>–£—Å–ª—É–≥–∞</th>
                                <th>–î–∞—Ç–∞</th>
                                <th>–í—Ä–µ–º—è</th>
                                <th>–°—Ç–∞—Ç—É—Å</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${bookingsHtml}
                        </tbody>
                    </table>
                `;
            }
        }

        function loadSchedule() {
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –∑–∞–ø–∏—Å–∏ –ø–æ –¥–Ω—è–º
            const scheduleByDay = {};
            appointments.forEach(apt => {
                const date = new Date(apt.date).toLocaleDateString('ru-RU');
                if (!scheduleByDay[date]) {
                    scheduleByDay[date] = [];
                }
                scheduleByDay[date].push(apt);
            });

            let scheduleHtml = '<div class="schedule-list">';
            
            if (Object.keys(scheduleByDay).length === 0) {
                scheduleHtml += '<p>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ</p>';
            } else {
                Object.entries(scheduleByDay).forEach(([date, dayAppointments]) => {
                    scheduleHtml += `
                        <div class="schedule-day">
                            <h4>${date}</h4>
                            <div class="appointments-list">
                    `;
                    
                    dayAppointments.forEach(apt => {
                        scheduleHtml += `
                            <div class="appointment-item ${apt.status}">
                                <div class="appointment-time">${apt.time || '–í—Ä–µ–º—è –Ω–µ —É–∫–∞–∑–∞–Ω–æ'}</div>
                                <div class="appointment-details">
                                    <strong>${apt.childName || '–†–µ–±–µ–Ω–æ–∫'}</strong> - ${apt.service || '–£—Å–ª—É–≥–∞'}
                                    <br><small>–†–æ–¥–∏—Ç–µ–ª—å: ${apt.parentName || '–ù–µ —É–∫–∞–∑–∞–Ω'}</small>
                                    <span class="status-badge ${apt.status}">${apt.status === 'confirmed' ? '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' : '–û–∂–∏–¥–∞–µ—Ç'}</span>
                                </div>
                            </div>
                        `;
                    });
                    
                    scheduleHtml += '</div></div>';
                });
            }
            
            scheduleHtml += '</div>';

            const scheduleContent = document.getElementById('scheduleContent');
            if (scheduleContent) {
                scheduleContent.innerHTML = scheduleHtml;
            }
        }

        function loadMessages() {
            const messageCenterHtml = `
                <div class="messages-center">
                    <div class="message-stats">
                        <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π</h4>
                        <p>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: <strong>0</strong></p>
                        <p>–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: <strong>0</strong></p>
                    </div>
                    
                    <div class="quick-message">
                        <h4>–ë—ã—Å—Ç—Ä–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ</h4>
                        <form class="quick-message-form">
                            <div class="form-group">
                                <label>–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –ø–æ–ª—É—á–∞—Ç–µ–ª—è</label>
                                <input type="tel" placeholder="+7 777 123 45 67" id="messagePhone">
                            </div>
                            <div class="form-group">
                                <label>–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è</label>
                                <textarea placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è" id="messageText" rows="3"></textarea>
                            </div>
                            <button type="button" class="btn-primary" onclick="sendQuickMessage()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        </form>
                    </div>
                </div>
            `;

            const messagesContent = document.getElementById('messagesContent');
            if (messagesContent) {
                messagesContent.innerHTML = messageCenterHtml;
            }
        }
        
        function sendQuickMessage() {
            const phone = document.getElementById('messagePhone')?.value;
            const text = document.getElementById('messageText')?.value;
            
            if (!phone || !text) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å WhatsApp –∏–ª–∏ SMS API
            alert(`–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è ${phone}:\n\n"${text}"\n\n(–í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫–∞)`);
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('messagePhone').value = '';
            document.getElementById('messageText').value = '';
        }

        function loadAnalytics() {
            const requests = JSON.parse(localStorage.getItem('requests') || '[]');
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            const registeredUsers = JSON.parse(localStorage.getItem('registeredUsers') || '{}');

            const totalRevenue = requests.reduce((sum, req) => sum + (parseInt(req.amount) || 0), 0);
            const avgRevenue = requests.length > 0 ? Math.round(totalRevenue / requests.length) : 0;
            const confirmedAppointments = appointments.filter(apt => apt.status === 'confirmed').length;
            const pendingAppointments = appointments.filter(apt => apt.status === 'pending').length;

            const analyticsHtml = `
                <div class="analytics-grid">
                    <div class="analytics-card">
                        <h4>–û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                        <p><strong>–í—Å–µ–≥–æ –∫–ª–∏–µ–Ω—Ç–æ–≤:</strong> ${Object.keys(registeredUsers).length + 1}</p>
                        <p><strong>–û–±—â–∏–π –¥–æ—Ö–æ–¥:</strong> ${totalRevenue.toLocaleString()}‚Ç∏</p>
                        <p><strong>–°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞:</strong> ${avgRevenue.toLocaleString()}‚Ç∏</p>
                    </div>
                    <div class="analytics-card">
                        <h4>–ó–∞–ø–∏—Å–∏</h4>
                        <p><strong>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:</strong> ${confirmedAppointments}</p>
                        <p><strong>–û–∂–∏–¥–∞–µ—Ç:</strong> ${pendingAppointments}</p>
                        <p><strong>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π:</strong> ${appointments.length}</p>
                    </div>
                    <div class="analytics-card">
                        <h4>–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —É—Å–ª—É–≥–∏</h4>
                        ${getPopularServices(requests)}
                    </div>
                </div>
            `;

            const analyticsContent = document.getElementById('analyticsContent');
            if (analyticsContent) {
                analyticsContent.innerHTML = analyticsHtml;
            }
        }

        function loadFinance() {
            const requests = JSON.parse(localStorage.getItem('requests') || '[]');
            
            const monthlyRevenue = requests.reduce((sum, req) => sum + (parseInt(req.amount) || 0), 0);
            const totalPayments = requests.length;
            
            // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –ø–æ —É—Å–ª—É–≥–∞–º
            const servicesRevenue = {};
            requests.forEach(req => {
                const service = req.service || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                servicesRevenue[service] = (servicesRevenue[service] || 0) + (parseInt(req.amount) || 0);
            });

            let servicesHtml = '';
            Object.entries(servicesRevenue).forEach(([service, amount]) => {
                servicesHtml += `<div class="service-row">
                    <span class="service-name">${service}</span>
                    <span class="service-amount">${amount.toLocaleString()}‚Ç∏</span>
                </div>`;
            });

            const financeHtml = `
                <div class="finance-summary">
                    <div class="finance-card main">
                        <h3>–û–±—â–∏–π –¥–æ—Ö–æ–¥</h3>
                        <div class="revenue-amount">${monthlyRevenue.toLocaleString()}‚Ç∏</div>
                        <p>–í—Å–µ–≥–æ –ø–ª–∞—Ç–µ–∂–µ–π: ${totalPayments}</p>
                    </div>
                </div>
                
                <div class="finance-details">
                    <h4>–î–æ—Ö–æ–¥—ã –ø–æ —É—Å–ª—É–≥–∞–º</h4>
                    <div class="services-list">
                        ${servicesHtml || '<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –¥–æ—Ö–æ–¥–∞—Ö</p>'}
                    </div>
                </div>
            `;

            const financeContent = document.getElementById('financeContent');
            if (financeContent) {
                financeContent.innerHTML = financeHtml;
            }
        }

        function getPopularServices(requests) {
            const services = {};
            requests.forEach(req => {
                const service = req.service || '–ù–µ —É–∫–∞–∑–∞–Ω–∞';
                services[service] = (services[service] || 0) + 1;
            });

            const sortedServices = Object.entries(services)
                .sort(([,a], [,b]) => b - a)
                .slice(0, 3);

            if (sortedServices.length === 0) {
                return '<p>–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ —É—Å–ª—É–≥–∞—Ö</p>';
            }

            return sortedServices.map(([service, count]) => 
                `<p><strong>${service}:</strong> ${count} —Ä–∞–∑</p>`
            ).join('');
        }

        // –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function loadChildBooking() {
            const bookingHtml = `
                <div class="booking-form">
                    <form id="childBookingForm" class="admin-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="childParentName">–ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è</label>
                                <input type="text" id="childParentName" required>
                            </div>
                            <div class="form-group">
                                <label for="childParentPhone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                <input type="tel" id="childParentPhone" placeholder="+7 777 123 45 67" required>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="childName">–ò–º—è —Ä–µ–±–µ–Ω–∫–∞</label>
                                <input type="text" id="childName" required>
                            </div>
                            <div class="form-group">
                                <label for="childAge">–í–æ–∑—Ä–∞—Å—Ç</label>
                                <input type="number" id="childAge" min="1" max="12" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="selectedService">–£—Å–ª—É–≥–∞</label>
                            <select id="selectedService" required>
                                <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>
                                <option value="early-development">–†–∞–Ω–Ω–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ (1-3 –≥–æ–¥–∞)</option>
                                <option value="preschool">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ (4-6 –ª–µ—Ç)</option>
                                <option value="art">–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –ò–ó–û</option>
                                <option value="dance">–¢–∞–Ω—Ü—ã –∏ –º—É–∑—ã–∫–∞</option>
                                <option value="english">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫</option>
                                <option value="individual">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è</option>
                            </select>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bookingDate">–î–∞—Ç–∞</label>
                                <input type="date" id="bookingDate" required>
                            </div>
                            <div class="form-group">
                                <label for="bookingTime">–í—Ä–µ–º—è</label>
                                <input type="time" id="bookingTime" required>
                            </div>
                        </div>
                        <button type="submit" class="btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å —Ä–µ–±–µ–Ω–∫–∞</button>
                    </form>
                </div>
            `;

            const content = document.getElementById('childBookingContent');
            if (content) {
                content.innerHTML = bookingHtml;
                
                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Ñ–æ—Ä–º—ã
                document.getElementById('childBookingForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    alert('–†–µ–±–µ–Ω–æ–∫ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–∏—Å–∞–Ω!');
                });
            }
        }

        function loadConfirmBooking() {
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            const pendingBookings = appointments.filter(apt => apt.status === 'pending');

            const bookingHtml = `
                <div class="confirm-list">
                    ${pendingBookings.length === 0 ? 
                        '<p>–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π, –æ–∂–∏–¥–∞—é—â–∏—Ö –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</p>' :
                        pendingBookings.map(apt => `
                            <div class="booking-item">
                                <div class="booking-info">
                                    <h4>${apt.childName} - ${apt.service}</h4>
                                    <p><strong>–†–æ–¥–∏—Ç–µ–ª—å:</strong> ${apt.parentName}</p>
                                    <p><strong>–î–∞—Ç–∞:</strong> ${new Date(apt.date).toLocaleDateString('ru-RU')}</p>
                                    <p><strong>–í—Ä–µ–º—è:</strong> ${apt.time}</p>
                                </div>
                                <div class="booking-actions">
                                    <button class="btn-success" onclick="confirmBooking('${apt.childName}')">
                                        <i class="fas fa-check"></i> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
                                    </button>
                                    <button class="btn-danger" onclick="cancelBooking('${apt.childName}')">
                                        <i class="fas fa-times"></i> –û—Ç–º–µ–Ω–∏—Ç—å
                                    </button>
                                </div>
                            </div>
                        `).join('')
                    }
                </div>
            `;

            const content = document.getElementById('confirmBookingContent');
            if (content) {
                content.innerHTML = bookingHtml;
            }
        }

        function loadBookingCalendar() {
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            
            const calendarHtml = `
                <div class="calendar-view">
                    <div class="calendar-header">
                        <h3>–ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–ø–∏—Å–µ–π</h3>
                        <p>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: <strong style="color: #000;">${appointments.length}</strong></p>
                    </div>
                    <div class="calendar-grid">
                        ${Object.entries(groupAppointmentsByDate(appointments)).map(([date, dayAppointments]) => `
                            <div class="calendar-day">
                                <h4>${new Date(date).toLocaleDateString('ru-RU')}</h4>
                                <div class="day-appointments">
                                    ${dayAppointments.map(apt => `
                                        <div class="appointment-badge ${apt.status}">
                                            ${apt.time} - ${apt.childName}
                                        </div>
                                    `).join('')}
                                </div>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;

            const content = document.getElementById('bookingCalendarContent');
            if (content) {
                content.innerHTML = calendarHtml;
            }
        }

        function loadLessons() {
            const lessonsHtml = `
                <div class="lessons-management">
                    <div class="lessons-stats">
                        <div class="stat-item">
                            <h3 style="color: #000;">0</h3>
                            <p>–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —É—Ä–æ–∫–æ–≤</p>
                        </div>
                        <div class="stat-item">
                            <h3 style="color: #000;">0</h3>
                            <p>–ü—Ä–æ–≤–µ–¥–µ–Ω–æ —É—Ä–æ–∫–æ–≤</p>
                        </div>
                    </div>
                    <div class="lessons-schedule">
                        <h4>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ —É—Ä–æ–∫–æ–≤</h4>
                        <p>–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —É—Ä–æ–∫–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω</p>
                    </div>
                </div>
            `;

            const content = document.getElementById('lessonsContent');
            if (content) {
                content.innerHTML = lessonsHtml;
            }
        }

        function loadWhatsApp() {
            const whatsappHtml = `
                <div class="whatsapp-center">
                    <div class="broadcast-form">
                        <h4>–ú–∞—Å—Å–æ–≤–∞—è —Ä–∞—Å—Å—ã–ª–∫–∞</h4>
                        <form id="broadcastForm">
                            <div class="form-group">
                                <label for="broadcastMessage">–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Ä–æ–¥–∏—Ç–µ–ª–µ–π</label>
                                <textarea id="broadcastMessage" rows="4" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —Ä–∞—Å—Å—ã–ª–∫–∏" required></textarea>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id="selectAllParents">
                                    –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–º —Ä–æ–¥–∏—Ç–µ–ª—è–º
                                </label>
                            </div>
                            <button type="submit" class="btn-primary">
                                <i class="fab fa-whatsapp"></i> –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ WhatsApp
                            </button>
                        </form>
                    </div>
                    <div class="broadcast-stats">
                        <h4>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å—Å—ã–ª–æ–∫</h4>
                        <p>–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–π: <strong style="color: #000;">0</strong></p>
                        <p>–î–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: <strong style="color: #000;">0</strong></p>
                    </div>
                </div>
            `;

            const content = document.getElementById('whatsappContent');
            if (content) {
                content.innerHTML = whatsappHtml;
                
                document.getElementById('broadcastForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const message = document.getElementById('broadcastMessage').value;
                    alert(`–°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ WhatsApp:\n\n"${message}"`);
                });
            }
        }

        function loadPayment() {
            const todayPayments = JSON.parse(localStorage.getItem('requests') || '[]');
            const todayTotal = todayPayments.reduce((sum, req) => sum + (parseInt(req.amount) || 0), 0);

            const paymentHtml = `
                <div class="payment-center">
                    <div class="receive-payment">
                        <h4>–ü—Ä–∏–µ–º –æ–ø–ª–∞—Ç—ã</h4>
                        <form id="receivePaymentForm">
                            <div class="form-group">
                                <label for="paymentParent">–†–æ–¥–∏—Ç–µ–ª—å</label>
                                <input type="text" id="paymentParent" placeholder="–ò–º—è —Ä–æ–¥–∏—Ç–µ–ª—è" required>
                            </div>
                            <div class="form-group">
                                <label for="paymentChild">–†–µ–±–µ–Ω–æ–∫</label>
                                <input type="text" id="paymentChild" placeholder="–ò–º—è —Ä–µ–±–µ–Ω–∫–∞" required>
                            </div>
                            <div class="form-group">
                                <label for="paymentAmount">–°—É–º–º–∞ (‚Ç∏)</label>
                                <input type="number" id="paymentAmount" placeholder="15000" required>
                            </div>
                            <div class="form-group">
                                <label for="paymentService">–£—Å–ª—É–≥–∞</label>
                                <select id="paymentService" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>
                                    <option value="early-development">–†–∞–Ω–Ω–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ</option>
                                    <option value="preschool">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ</option>
                                    <option value="art">–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ</option>
                                    <option value="dance">–¢–∞–Ω—Ü—ã</option>
                                    <option value="english">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π</option>
                                </select>
                            </div>
                            <button type="submit" class="btn-primary">
                                <i class="fas fa-credit-card"></i> –ü—Ä–∏–Ω—è—Ç—å –æ–ø–ª–∞—Ç—É
                            </button>
                        </form>
                    </div>
                    <div class="payment-today">
                        <h4>–û–ø–ª–∞—Ç—ã –∑–∞ —Å–µ–≥–æ–¥–Ω—è</h4>
                        <div class="today-stats">
                            <h3 style="color: #000;">${todayTotal.toLocaleString()}‚Ç∏</h3>
                            <p>–û–±—â–∞—è —Å—É–º–º–∞</p>
                        </div>
                    </div>
                </div>
            `;

            const content = document.getElementById('paymentContent');
            if (content) {
                content.innerHTML = paymentHtml;
                
                document.getElementById('receivePaymentForm')?.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const amount = document.getElementById('paymentAmount').value;
                    alert(`–û–ø–ª–∞—Ç–∞ ${amount}‚Ç∏ –ø—Ä–∏–Ω—è—Ç–∞!`);
                });
            }
        }

        function loadDailyReport() {
            const today = new Date().toISOString().split('T')[0];
            const requests = JSON.parse(localStorage.getItem('requests') || '[]');
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            
            const todayRequests = requests.filter(req => req.date?.startsWith(today));
            const todayAppointments = appointments.filter(apt => apt.date?.startsWith(today));
            
            const todayRevenue = todayRequests.reduce((sum, req) => sum + (parseInt(req.amount) || 0), 0);
            const confirmedToday = todayAppointments.filter(apt => apt.status === 'confirmed').length;

            const reportHtml = `
                <div class="daily-report">
                    <div class="report-header">
                        <h3>–û—Ç—á–µ—Ç –∑–∞ ${new Date().toLocaleDateString('ru-RU')}</h3>
                    </div>
                    <div class="report-grid">
                        <div class="report-item revenue">
                            <h3 style="color: #000;">${todayRevenue.toLocaleString()}‚Ç∏</h3>
                            <p>–î–æ—Ö–æ–¥ –∑–∞ –¥–µ–Ω—å</p>
                        </div>
                        <div class="report-item payments">
                            <h3 style="color: #000;">${todayRequests.length}</h3>
                            <p>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–ø–ª–∞—Ç</p>
                        </div>
                        <div class="report-item appointments">
                            <h3 style="color: #000;">${todayAppointments.length}</h3>
                            <p>–ó–∞–ø–∏—Å–µ–π –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</p>
                        </div>
                        <div class="report-item confirmed">
                            <h3 style="color: #000;">${confirmedToday}</h3>
                            <p>–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ</p>
                        </div>
                    </div>
                    <div class="report-actions">
                        <button class="btn-primary" onclick="printDailyReport()">
                            <i class="fas fa-print"></i> –†–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å –æ—Ç—á–µ—Ç
                        </button>
                        <button class="btn-secondary" onclick="exportDailyReport()">
                            <i class="fas fa-download"></i> –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                        </button>
                    </div>
                </div>
            `;

            const content = document.getElementById('dailyReportContent');
            if (content) {
                content.innerHTML = reportHtml;
            }
        }

        function groupAppointmentsByDate(appointments) {
            const grouped = {};
            appointments.forEach(apt => {
                const date = apt.date.split('T')[0];
                if (!grouped[date]) {
                    grouped[date] = [];
                }
                grouped[date].push(apt);
            });
            return grouped;
        }

        function confirmBooking(childName) {
            alert(`–ó–∞–ø–∏—Å—å –¥–ª—è ${childName} –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!`);
        }

        function cancelBooking(childName) {
            if (confirm(`–û—Ç–º–µ–Ω–∏—Ç—å –∑–∞–ø–∏—Å—å –¥–ª—è ${childName}?`)) {
                alert(`–ó–∞–ø–∏—Å—å –¥–ª—è ${childName} –æ—Ç–º–µ–Ω–µ–Ω–∞`);
            }
        }

        function loadStaffManagement() {
            // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const baseUsers = [
                { name: 'Raxa (–í–ª–∞–¥–µ–ª–µ—Ü)', login: 'Raxa', role: 'owner', status: 'active' },
                { name: 'Admin1 (–°–æ—Ç—Ä—É–¥–Ω–∏–∫)', login: 'Admin1', role: 'admin', status: 'active' }
            ];

            // –ü–æ–ª—É—á–∞–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ localStorage
            const customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
            
            // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –Ω—É–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
            const customUsersFormatted = customUsers.map(user => ({
                name: `${user.name} (${user.role === 'owner' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : '–°–æ—Ç—Ä—É–¥–Ω–∏–∫'})`,
                login: user.login,
                role: user.role,
                status: 'active',
                isCustom: true
            }));

            // –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            const allUsers = [...baseUsers, ...customUsersFormatted];

            const staffHtml = `
                <div class="staff-management">
                    <div class="management-actions">
                        <button class="btn-primary" onclick="openAddUserModal()">
                            <i class="fas fa-plus"></i> –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
                        </button>
                    </div>
                    
                    <div class="staff-list">
                        <h4>–°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ (${allUsers.length})</h4>
                        <div class="users-grid">
                            ${allUsers.map(user => `
                                <div class="staff-card">
                                    <div class="staff-info">
                                        <h4>${user.name}</h4>
                                        <p><strong>–õ–æ–≥–∏–Ω:</strong> ${user.login}</p>
                                        <p><strong>–†–æ–ª—å:</strong> ${user.role === 'owner' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : '–°–æ—Ç—Ä—É–¥–Ω–∏–∫'}</p>
                                        <p><strong>–°—Ç–∞—Ç—É—Å:</strong> <span class="status-${user.status}">${user.status === 'active' ? '–ê–∫—Ç–∏–≤–µ–Ω' : '–ù–µ–∞–∫—Ç–∏–≤–µ–Ω'}</span></p>
                                    </div>
                                    <div class="staff-actions">
                                        <button class="btn-secondary" onclick="editUser('${user.login}')">
                                            <i class="fas fa-edit"></i> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
                                        </button>
                                        ${user.login !== 'Raxa' && user.login !== 'Admin1' ? `
                                            <button class="btn-danger" onclick="deleteUser('${user.login}')">
                                                <i class="fas fa-trash"></i> –£–¥–∞–ª–∏—Ç—å
                                            </button>
                                        ` : ''}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;

            const content = document.getElementById('staffManagementContent');
            if (content) {
                content.innerHTML = staffHtml;
            }
        }

        function openAddUserModal() {
            if (currentUser.role !== 'owner' && currentUser.type !== 'owner') return;
            openModal('addUserModal');
        }

        function handleAddUser(e) {
            e.preventDefault();
            
            const userType = document.getElementById('newUserType').value;
            const userName = document.getElementById('newUserName').value;
            const userLogin = document.getElementById('newUserLogin').value;
            const userPassword = document.getElementById('newUserPassword').value;

            if (!userType || !userName || !userLogin || !userPassword) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage
            const newUser = {
                login: userLogin,
                password: userPassword,
                name: userName,
                role: userType,
                addedDate: new Date().toISOString()
            };

            // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ localStorage
            let customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –¥—É–±–ª–∏–∫–∞—Ç –ª–æ–≥–∏–Ω–∞
            const exists = customUsers.some(user => user.login === userLogin);
            if (exists) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!');
                return;
            }

            // –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            customUsers.push(newUser);
            localStorage.setItem('customUsers', JSON.stringify(customUsers));

            alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${userName} —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω –∫–∞–∫ ${userType === 'owner' ? '–í–ª–∞–¥–µ–ª–µ—Ü' : '–°–æ—Ç—Ä—É–¥–Ω–∏–∫'}!`);
            
            // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏ –æ—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            closeModal('addUserModal');
            document.getElementById('addUserForm').reset();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–∫—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞
            const staffManagementTab = document.getElementById('staffManagementTab');
            if (staffManagementTab && staffManagementTab.classList.contains('active')) {
                loadStaffManagement();
            }
        }

        function editUser(login) {
            if (currentUser.role !== 'owner' && currentUser.type !== 'owner') return;
            
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–∞–≤
            const modal = document.getElementById('editUserModal') || createEditUserModal();
            modal.style.display = 'block';
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            document.getElementById('editUserLogin').value = login;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            loadUserPermissions(login);
        }
        
        function loadUserPermissions(login) {
            // –ü–æ–ª—É—á–∞–µ–º –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
            const user = customUsers.find(u => u.login === login);
            
            if (user && user.permissions) {
                // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞
                Object.keys(user.permissions).forEach(permission => {
                    const checkbox = document.getElementById(`perm_${permission}`);
                    if (checkbox) {
                        checkbox.checked = user.permissions[permission];
                    }
                });
            } else {
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∞–≤–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –∞–¥–º–∏–Ω–æ–≤
                if (login !== 'Raxa') {
                    const defaultPermissions = {
                        'childBooking': true,
                        'confirmBooking': true,
                        'bookingCalendar': true,
                        'lessons': true,
                        'whatsapp': true,
                        'payment': true,
                        'dailyReport': true
                    };
                    
                    Object.keys(defaultPermissions).forEach(permission => {
                        const checkbox = document.getElementById(`perm_${permission}`);
                        if (checkbox) {
                            checkbox.checked = defaultPermissions[permission];
                        }
                    });
                }
            }
        }
        
        function saveUserPermissions() {
            const login = document.getElementById('editUserLogin').value;
            const permissions = {
                'childBooking': document.getElementById('perm_childBooking')?.checked || false,
                'confirmBooking': document.getElementById('perm_confirmBooking')?.checked || false,
                'bookingCalendar': document.getElementById('perm_bookingCalendar')?.checked || false,
                'lessons': document.getElementById('perm_lessons')?.checked || false,
                'whatsapp': document.getElementById('perm_whatsapp')?.checked || false,
                'payment': document.getElementById('perm_payment')?.checked || false,
                'dailyReport': document.getElementById('perm_dailyReport')?.checked || false
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∞–≤–∞ –≤ localStorage
            let customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
            const userIndex = customUsers.findIndex(u => u.login === login);
            
            if (userIndex !== -1) {
                customUsers[userIndex].permissions = permissions;
                localStorage.setItem('customUsers', JSON.stringify(customUsers));
            }
            
            alert(`–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è ${login} —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!`);
            closeModal('editUserModal');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–∫—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞
            const staffManagementTab = document.getElementById('staffManagementTab');
            if (staffManagementTab && staffManagementTab.classList.contains('active')) {
                loadStaffManagement();
            }
        }

        function deleteUser(login) {
            if (currentUser.role !== 'owner' && currentUser.type !== 'owner') return;
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ–ª—å–∑—è –ª–∏ —É–¥–∞–ª–∏—Ç—å –±–∞–∑–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
            if (login === 'Raxa' || login === 'Admin1') {
                alert('–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å –±–∞–∑–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å–∏—Å—Ç–µ–º—ã');
                return;
            }
            
            if (confirm(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${login}?`)) {
                // –£–¥–∞–ª—è–µ–º –∏–∑ localStorage
                let customUsers = JSON.parse(localStorage.getItem('customUsers') || '[]');
                customUsers = customUsers.filter(user => user.login !== login);
                localStorage.setItem('customUsers', JSON.stringify(customUsers));
                
                alert(`–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å ${login} —É–¥–∞–ª–µ–Ω –∏–∑ —Å–∏—Å—Ç–µ–º—ã`);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å–µ–∫—Ü–∏—é —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º–∏, –µ—Å–ª–∏ –æ–Ω–∞ –∞–∫—Ç–∏–≤–Ω–∞
                const staffManagementTab = document.getElementById('staffManagementTab');
                if (staffManagementTab && staffManagementTab.classList.contains('active')) {
                    loadStaffManagement();
                }
            }
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function openModal(modalId) {
            document.getElementById(modalId).style.display = 'block';
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ–∫–æ–≤—ã–º –º–µ–Ω—é –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        function toggleSidebar() {
            const sidebar = document.querySelector('.sidebar');
            sidebar.classList.toggle('active');
        }

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
        document.addEventListener('click', function(event) {
            const sidebar = document.querySelector('.sidebar');
            const toggleButton = document.querySelector('.sidebar-toggle');
            
            if (window.innerWidth <= 768 && 
                sidebar.classList.contains('active') && 
                !sidebar.contains(event.target) && 
                !toggleButton.contains(event.target)) {
                sidebar.classList.remove('active');
            }
        });

        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –±–æ–∫–æ–≤–æ–µ –º–µ–Ω—é –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç–∫—Ä–∞–Ω–∞
        window.addEventListener('resize', function() {
            const sidebar = document.querySelector('.sidebar');
            if (window.innerWidth > 768) {
                sidebar.classList.remove('active');
            }
        });
    </script>
</body>
</html>
