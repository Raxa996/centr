<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <!-- <base href="/centr/"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è - –¶–µ–Ω—Ç—Ä "–†–∞–¥—É–≥–∞"</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script>
      window.PUBLIC_SUPABASE_URL = "https://estplmvqprqbobrjicmd.supabase.co";
      window.PUBLIC_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVzdHBsbXZxcHJxYm9icmppY21kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjEwMzQxNTUsImV4cCI6MjA3NjYxMDE1NX0.dZrGpi9mJ_oZqVn0LlzVqzOQMLSH097DT2jlOGuArpc";
    </script>
    <script src="supabaseClient.js"></script>
    <script src="script.js"></script>
</head>
<body>
    <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <h2>üåà –¶–µ–Ω—Ç—Ä "–†–∞–¥—É–≥–∞"</h2>
            </div>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a href="index.html" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a>
                </li>
                <li class="nav-item">
                    <span class="nav-link" id="userName">–†–æ–¥–∏—Ç–µ–ª—å</span>
                </li>
                <li class="nav-item">
                    <button class="btn-secondary" onclick="logout()">–í—ã–π—Ç–∏</button>
                </li>
            </ul>
        </div>
    </nav>

    <div class="dashboard">
        <div class="dashboard-layout">
            <!-- –ë–æ–∫–æ–≤–æ–µ –º–µ–Ω—é -->
            <div class="sidebar">
                <div class="sidebar-menu">
                    <div class="menu-item active" onclick="showTab('overview')">
                        <i class="fas fa-chart-bar"></i>
                        <span>–û–±–∑–æ—Ä</span>
                    </div>
                    <div class="menu-item" onclick="showTab('progress')">
                        <i class="fas fa-chart-line"></i>
                        <span>–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å</span>
                    </div>
                    <div class="menu-item" onclick="showTab('notes')">
                        <i class="fas fa-sticky-note"></i>
                        <span>–ó–∞–º–µ—Ç–∫–∏ –∏ –î–ó</span>
                    </div>
                    <div class="menu-item" onclick="showTab('schedule')">
                        <i class="fas fa-calendar"></i>
                        <span>–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
                    </div>
                    <div class="menu-item" onclick="showTab('booking')">
                        <i class="fas fa-calendar-plus"></i>
                        <span>–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</span>
                    </div>
                    <div class="menu-item" onclick="showTab('payment')">
                        <i class="fas fa-credit-card"></i>
                        <span>–û–ø–ª–∞—Ç–∞</span>
                    </div>
                    <div class="menu-item" onclick="showTab('profile')">
                        <i class="fas fa-user"></i>
                        <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                    </div>
                </div>
            </div>

            <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
            <div class="main-content">
                <div class="container">

            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ -->
            <div id="overview" class="tab-content active">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–û–±–∑–æ—Ä</h2>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number" id="totalChildren">1</div>
                            <div class="stat-label">–î–µ—Ç–µ–π –∑–∞–ø–∏—Å–∞–Ω–æ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="activeServices">2</div>
                            <div class="stat-label">–ê–∫—Ç–∏–≤–Ω—ã—Ö —É—Å–ª—É–≥</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="nextLesson">–ó–∞–≤—Ç—Ä–∞</div>
                            <div class="stat-label">–ë–ª–∏–∂–∞–π—à–µ–µ –∑–∞–Ω—è—Ç–∏–µ</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number" id="balance">0 ‚Ç∏</div>
                            <div class="stat-label">–ë–∞–ª–∞–Ω—Å</div>
                        </div>
                    </div>

                    <h3>–ë–ª–∏–∂–∞–π—à–∏–µ –∑–∞–Ω—è—Ç–∏—è</h3>
                    <div class="upcoming-lessons" id="upcomingLessons">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                    </div>
                </div>
            </div>

            <div id="progress" class="tab-content">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–£—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å —Ä–µ–±–µ–Ω–∫–∞</h2>
                    <div class="progress-filters">
                        <select id="childSelect">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞</option>
                        </select>
                        <select id="serviceSelect">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>
                        </select>
                    </div>
                    <div class="progress-table" id="progressData">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                    </div>
                </div>
            </div>

            <div id="notes" class="tab-content">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–ó–∞–º–µ—Ç–∫–∏ –∏ –¥–æ–º–∞—à–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è</h2>
                    <div class="notes-filters">
                        <select id="childSelectNotes">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞</option>
                        </select>
                    </div>
                    <div class="notes-list" id="notesData">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                    </div>
                </div>
            </div>

            <div id="schedule" class="tab-content">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π</h2>
                    <div class="calendar-container">
                        <div class="calendar-controls">
                            <button onclick="changeMonth(-1)">‚Üê</button>
                            <span id="currentMonth"></span>
                            <button onclick="changeMonth(1)">‚Üí</button>
                        </div>
                        <div class="calendar" id="parentCalendar">
                            <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                        </div>
                    </div>
                </div>
            </div>

            <div id="booking" class="tab-content">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–ó–∞–ø–∏—Å—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è</h2>
                    <form id="bookingForm" class="booking-form">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bookingChild">–†–µ–±–µ–Ω–æ–∫</label>
                                <select id="bookingChild" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="bookingService">–£—Å–ª—É–≥–∞</label>
                                <select id="bookingService" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —É—Å–ª—É–≥—É</option>
                                    <option value="early-development">–†–∞–Ω–Ω–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ</option>
                                    <option value="preschool">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ</option>
                                    <option value="art">–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –ò–ó–û</option>
                                    <option value="dance">–¢–∞–Ω—Ü—ã –∏ –º—É–∑—ã–∫–∞</option>
                                    <option value="english">–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫</option>
                                    <option value="individual">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="bookingDate">–î–∞—Ç–∞</label>
                                <input type="date" id="bookingDate" required>
                            </div>
                            <div class="form-group">
                                <label for="bookingTime">–í—Ä–µ–º—è</label>
                                <select id="bookingTime" required>
                                    <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</option>
                                    <option value="09:00">09:00</option>
                                    <option value="10:00">10:00</option>
                                    <option value="11:00">11:00</option>
                                    <option value="12:00">12:00</option>
                                    <option value="13:00">13:00</option>
                                    <option value="14:00">14:00</option>
                                    <option value="15:00">15:00</option>
                                    <option value="16:00">16:00</option>
                                    <option value="17:00">17:00</option>
                                    <option value="18:00">18:00</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="bookingNotes">–ü—Ä–∏–º–µ—á–∞–Ω–∏—è</label>
                            <textarea id="bookingNotes" rows="3"></textarea>
                        </div>
                        <button type="submit" class="btn-primary">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è</button>
                    </form>

                    <h3>–î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã</h3>
                    <div class="available-slots" id="availableSlots">
                        <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                    </div>
                </div>
            </div>

            <div id="payment" class="tab-content">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–û–ø–ª–∞—Ç–∞ —É—Å–ª—É–≥</h2>
                    
                    <div class="payment-summary">
                        <h3>–ö –æ–ø–ª–∞—Ç–µ</h3>
                        <div class="invoices-list" id="invoicesList">
                            <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                        </div>
                    </div>

                    <div class="payment-methods">
                        <h3>–°–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã</h3>
                        <div class="payment-cards">
                            <div class="payment-card" onclick="selectPaymentMethod('kaspi')">
                                <i class="fas fa-credit-card"></i>
                                <span>Kaspi Pay</span>
                            </div>
                            <div class="payment-card" onclick="selectPaymentMethod('halyk')">
                                <i class="fas fa-university"></i>
                                <span>Halyk Bank</span>
                            </div>
                            <div class="payment-card" onclick="selectPaymentMethod('cash')">
                                <i class="fas fa-money-bill"></i>
                                <span>–ù–∞–ª–∏—á–Ω—ã–µ –≤ —Ü–µ–Ω—Ç—Ä–µ</span>
                            </div>
                        </div>
                    </div>

                    <div class="payment-history">
                        <h3>–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π</h3>
                        <table class="table" id="paymentHistory">
                            <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                        </table>
                    </div>
                </div>
            </div>

            <div id="profile" class="tab-content">
                <div class="dashboard-card">
                    <h2 class="dashboard-title">–ü—Ä–æ—Ñ–∏–ª—å</h2>
                    
                    <div class="profile-sections">
                        <div class="profile-section">
                            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–æ–¥–∏—Ç–µ–ª–µ</h3>
                            <form id="parentProfileForm">
                                <div class="form-group">
                                    <label for="parentFullName">–§–ò–û</label>
                                    <input type="text" id="parentFullName" required>
                                </div>
                                <div class="form-group">
                                    <label for="parentPhone">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                    <input type="tel" id="parentPhone" required>
                                </div>
                                <div class="form-group">
                                    <label for="parentEmail">Email</label>
                                    <input type="email" id="parentEmail" required>
                                </div>
                                <div class="form-group">
                                    <label for="parentAddress">–ê–¥—Ä–µ—Å</label>
                                    <input type="text" id="parentAddress">
                                </div>
                                <button type="submit" class="btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            </form>
                        </div>

                        <div class="profile-section">
                            <h3>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–µ—Ç—è—Ö</h3>
                            <div class="children-list" id="childrenList">
                                <!-- –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JavaScript -->
                            </div>
                            <button class="btn-secondary" onclick="addChildModal()">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞</button>
                        </div>
                    </div>
                </div>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–µ–±–µ–Ω–∫–∞ -->
    <div id="addChildModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('addChildModal')">&times;</span>
            <h2>–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–±–µ–Ω–∫–∞</h2>
            <form id="addChildForm">
                <div class="form-group">
                    <label for="childName">–ò–º—è —Ä–µ–±–µ–Ω–∫–∞</label>
                    <input type="text" id="childName" required>
                </div>
                <div class="form-group">
                    <label for="childBirthDate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                    <input type="date" id="childBirthDate" required>
                </div>
                <div class="form-group">
                    <label for="childGender">–ü–æ–ª</label>
                    <select id="childGender" required>
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–æ–ª</option>
                        <option value="male">–ú–∞–ª—å—á–∏–∫</option>
                        <option value="female">–î–µ–≤–æ—á–∫–∞</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="childNotes">–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ (–∞–ª–ª–µ—Ä–≥–∏–∏, –∑–∞–º–µ—á–∞–Ω–∏—è –≤—Ä–∞—á–∞ –∏ —Ç.–¥.)</label>
                    <textarea id="childNotes" rows="3"></textarea>
                </div>
                <button type="submit" class="btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–∞–±–∏–Ω–µ—Ç–∞
        document.addEventListener('DOMContentLoaded', function() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            const currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            if (!currentUser || currentUser.type !== 'parent') {
                window.location.href = 'index.html';
                return;
            }

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å —Ç–∏–ø–æ–º –¥–æ—Å—Ç—É–ø–∞
            const userNameElement = document.getElementById('userName');
            if (currentUser.displayName) {
                userNameElement.textContent = `${currentUser.displayName} (${currentUser.name})`;
            } else {
                userNameElement.textContent = currentUser.name || '–†–æ–¥–∏—Ç–µ–ª—å';
            }
            userNameElement.style.color = '#ffd700';
            userNameElement.style.fontWeight = 'bold';
            userNameElement.style.textShadow = '1px 1px 2px rgba(0,0,0,0.5)';
            loadParentDashboard();
        });

        let currentParentData = {
            children: [
                {
                    id: 1,
                    name: '–ú–∞–∫—Å–∏–º –ü–µ—Ç—Ä–æ–≤',
                    birthDate: '2019-03-15',
                    gender: 'male',
                    services: ['preschool', 'art']
                }
            ],
            profile: {
                fullName: '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤',
                phone: '+7 777 123 45 67',
                email: 'ivan.petrov@email.com',
                address: '—É–ª. –ê–±–∞—è, 10, –∫–≤. 5'
            }
        };

        function showTab(tabName) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º–µ–Ω—é
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –º–µ–Ω—é
            event.target.closest('.menu-item').classList.add('active');
            
            document.getElementById(tabName).classList.add('active');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–π –≤–∫–ª–∞–¥–∫–∏
            switch(tabName) {
                case 'overview':
                    loadOverview();
                    break;
                case 'progress':
                    loadProgress();
                    break;
                case 'notes':
                    loadNotes();
                    break;
                case 'schedule':
                    loadSchedule();
                    break;
                case 'booking':
                    loadBooking();
                    break;
                case 'payment':
                    loadPayment();
                    break;
                case 'profile':
                    loadProfile();
                    break;
            }
        }

        function loadParentDashboard() {
            loadOverview();
            loadChildrenSelects();
        }

        function loadOverview() {
            document.getElementById('totalChildren').textContent = currentParentData.children.length;
            
            let totalServices = 0;
            currentParentData.children.forEach(child => {
                totalServices += child.services.length;
            });
            document.getElementById('activeServices').textContent = totalServices;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –±–ª–∏–∂–∞–π—à–∏–µ –∑–∞–Ω—è—Ç–∏—è
            loadUpcomingLessons();
        }

        function loadUpcomingLessons() {
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            const upcomingLessons = appointments.filter(apt => {
                const aptDate = new Date(apt.date);
                return aptDate >= new Date() && 
                       currentParentData.children.some(child => child.name === apt.childName);
            }).slice(0, 5);

            const container = document.getElementById('upcomingLessons');
            if (upcomingLessons.length === 0) {
                container.innerHTML = '<p>–ë–ª–∏–∂–∞–π—à–∏—Ö –∑–∞–Ω—è—Ç–∏–π –Ω–µ—Ç</p>';
            } else {
                container.innerHTML = upcomingLessons.map(lesson => `
                    <div class="lesson-item">
                        <div class="lesson-date">${new Date(lesson.date).toLocaleDateString('ru-RU')}</div>
                        <div class="lesson-time">${lesson.time}</div>
                        <div class="lesson-service">${lesson.service}</div>
                        <div class="lesson-child">${lesson.childName}</div>
                    </div>
                `).join('');
            }
        }

        function loadProgress() {
            const progress = JSON.parse(localStorage.getItem('progress') || '[]');
            const progressData = document.getElementById('progressData');
            
            if (progress.length === 0) {
                progressData.innerHTML = '<p>–î–∞–Ω–Ω—ã—Ö –æ–± —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç–∏ –ø–æ–∫–∞ –Ω–µ—Ç</p>';
            } else {
                progressData.innerHTML = progress.map(item => `
                    <div class="progress-item">
                        <h4>${item.childName} - ${item.service}</h4>
                        <div class="progress-details">
                            ${item.progress.map(p => `
                                <div class="progress-entry">
                                    <span class="progress-date">${p.date}</span>
                                    <span class="progress-subject">${p.subject}</span>
                                    <span class="progress-grade grade-${p.grade}">${p.grade}</span>
                                    <span class="progress-comment">${p.comment}</span>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `).join('');
            }
        }

        function loadNotes() {
            const notesData = document.getElementById('notesData');
            notesData.innerHTML = `
                <div class="note-item">
                    <div class="note-date">15.01.2024</div>
                    <div class="note-child">–ú–∞–∫—Å–∏–º</div>
                    <div class="note-service">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ</div>
                    <div class="note-content">
                        <strong>–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ:</strong> –ü–æ–≤—Ç–æ—Ä–∏—Ç—å —Ü–∏—Ñ—Ä—ã –æ—Ç 1 –¥–æ 10, –≤—ã—É—á–∏—Ç—å —Å—Ç–∏—Ö–æ—Ç–≤–æ—Ä–µ–Ω–∏–µ "–ó–∏–º–∞"
                    </div>
                    <div class="note-teacher">–ü–µ–¥–∞–≥–æ–≥: –ê–Ω–Ω–∞ –°–µ—Ä–≥–µ–µ–≤–Ω–∞</div>
                </div>
                <div class="note-item">
                    <div class="note-date">20.01.2024</div>
                    <div class="note-child">–ú–∞–∫—Å–∏–º</div>
                    <div class="note-service">–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ</div>
                    <div class="note-content">
                        <strong>–ó–∞–º–µ—Ç–∫–∞:</strong> –†–µ–±–µ–Ω–æ–∫ –æ—á–µ–Ω—å —Ö–æ—Ä–æ—à–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫—Ä–∞—Å–∫–∞–º–∏, –ø—Ä–æ—è–≤–ª—è–µ—Ç —Ç–≤–æ—Ä—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥
                    </div>
                    <div class="note-teacher">–ü–µ–¥–∞–≥–æ–≥: –ú–∞—Ä–∏—è –ò–≤–∞–Ω–æ–≤–Ω–∞</div>
                </div>
            `;
        }

        function loadSchedule() {
            const today = new Date();
            generateCalendar(today.getFullYear(), today.getMonth());
            updateMonthDisplay(today.getFullYear(), today.getMonth());
        }

        function loadBooking() {
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –∑–∞–ø–∏—Å–∏
            const bookingForm = document.getElementById('bookingForm');
            bookingForm.addEventListener('submit', handleBookingSubmit);
            
            loadAvailableSlots();
        }

        function loadPayment() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—á–µ—Ç–∞ –∫ –æ–ø–ª–∞—Ç–µ
            const invoicesList = document.getElementById('invoicesList');
            invoicesList.innerHTML = `
                <div class="invoice-item">
                    <div class="invoice-details">
                        <div class="invoice-service">–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ - –Ø–Ω–≤–∞—Ä—å</div>
                        <div class="invoice-child">–ú–∞–∫—Å–∏–º –ü–µ—Ç—Ä–æ–≤</div>
                        <div class="invoice-date">–°—Ä–æ–∫ –æ–ø–ª–∞—Ç—ã: 25.01.2024</div>
                    </div>
                    <div class="invoice-amount">20,000 ‚Ç∏</div>
                    <button class="btn-primary" onclick="payInvoice(1)">–û–ø–ª–∞—Ç–∏—Ç—å</button>
                </div>
            `;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π
            const paymentHistory = document.getElementById('paymentHistory');
            paymentHistory.innerHTML = `
                <thead>
                    <tr>
                        <th>–î–∞—Ç–∞</th>
                        <th>–£—Å–ª—É–≥–∞</th>
                        <th>–†–µ–±–µ–Ω–æ–∫</th>
                        <th>–°—É–º–º–∞</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>15.12.2023</td>
                        <td>–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ - –î–µ–∫–∞–±—Ä—å</td>
                        <td>–ú–∞–∫—Å–∏–º –ü–µ—Ç—Ä–æ–≤</td>
                        <td>12,000 ‚Ç∏</td>
                        <td><span class="status-paid">–û–ø–ª–∞—á–µ–Ω–æ</span></td>
                    </tr>
                </tbody>
            `;
        }

        function loadProfile() {
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –ø—Ä–æ—Ñ–∏–ª—è
            const profile = currentParentData.profile;
            document.getElementById('parentFullName').value = profile.fullName;
            document.getElementById('parentPhone').value = profile.phone;
            document.getElementById('parentEmail').value = profile.email;
            document.getElementById('parentAddress').value = profile.address;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–ø–∏—Å–æ–∫ –¥–µ—Ç–µ–π
            loadChildrenList();
        }

        function loadChildrenSelects() {
            const selects = ['childSelect', 'childSelectNotes', 'bookingChild'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                if (select) {
                    select.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞</option>' +
                        currentParentData.children.map(child => 
                            `<option value="${child.id}">${child.name}</option>`
                        ).join('');
                }
            });
        }

        function loadChildrenList() {
            const childrenList = document.getElementById('childrenList');
            childrenList.innerHTML = currentParentData.children.map(child => `
                <div class="child-card">
                    <div class="child-info">
                        <h4>${child.name}</h4>
                        <p>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: ${new Date(child.birthDate).toLocaleDateString('ru-RU')}</p>
                        <p>–ü–æ–ª: ${child.gender === 'male' ? '–ú–∞–ª—å—á–∏–∫' : '–î–µ–≤–æ—á–∫–∞'}</p>
                        <p>–£—Å–ª—É–≥–∏: ${getServiceNames(child.services).join(', ')}</p>
                    </div>
                    <button class="btn-secondary" onclick="editChild(${child.id})">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                </div>
            `).join('');
        }

        function getServiceNames(serviceIds) {
            const serviceNames = {
                'early-development': '–†–∞–Ω–Ω–µ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ',
                'preschool': '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —à–∫–æ–ª–µ',
                'art': '–¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ –∏ –ò–ó–û',
                'dance': '–¢–∞–Ω—Ü—ã –∏ –º—É–∑—ã–∫–∞',
                'english': '–ê–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫',
                'individual': '–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è'
            };
            return serviceIds.map(id => serviceNames[id] || id);
        }

        function handleBookingSubmit(e) {
            e.preventDefault();
            
            const formData = {
                childId: document.getElementById('bookingChild').value,
                service: document.getElementById('bookingService').value,
                date: document.getElementById('bookingDate').value,
                time: document.getElementById('bookingTime').value,
                notes: document.getElementById('bookingNotes').value
            };

            const child = currentParentData.children.find(c => c.id == formData.childId);
            if (!child) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–±–µ–Ω–∫–∞');
                return;
            }

            // –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
            const appointments = JSON.parse(localStorage.getItem('appointments') || '[]');
            appointments.push({
                id: Date.now(),
                date: formData.date,
                time: formData.time,
                parentName: currentParentData.profile.fullName,
                childName: child.name,
                service: document.getElementById('bookingService').selectedOptions[0].text,
                notes: formData.notes,
                status: 'pending'
            });
            localStorage.setItem('appointments', JSON.stringify(appointments));

            alert('–ó–∞—è–≤–∫–∞ –Ω–∞ –∑–∞–ø–∏—Å—å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ú—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–º –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–∏–π.');
            e.target.reset();
        }

        function loadAvailableSlots() {
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã –≤—Ä–µ–º–µ–Ω–∏
            const availableSlots = document.getElementById('availableSlots');
            availableSlots.innerHTML = `
                <div class="slot-item">
                    <div class="slot-date">–ó–∞–≤—Ç—Ä–∞ (16.01)</div>
                    <div class="slot-times">
                        <button class="slot-btn" onclick="selectSlot('09:00')">09:00</button>
                        <button class="slot-btn" onclick="selectSlot('11:00')">11:00</button>
                        <button class="slot-btn" onclick="selectSlot('16:00')">16:00</button>
                    </div>
                </div>
            `;
        }

        function selectPaymentMethod(method) {
            alert(`–í—ã–±—Ä–∞–Ω —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã: ${method}`);
        }

        function payInvoice(invoiceId) {
            alert(`–û–ø–ª–∞—Ç–∞ —Å—á–µ—Ç–∞ ‚Ññ${invoiceId} –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç –≤–∞—Å –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –æ–ø–ª–∞—Ç—ã`);
        }

        function addChildModal() {
            openModal('addChildModal');
        }

        function logout() {
            localStorage.removeItem('currentUser');
            window.location.href = 'index.html';
        }

        // –ü–æ–¥–∫–ª—é—á–∞–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ script.js
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'block';
            }
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function generateCalendar(year, month) {
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ script.js
            if (typeof window.generateCalendar === 'function') {
                window.generateCalendar(year, month);
            }
        }

        function updateMonthDisplay(year, month) {
            const monthNames = ['–Ø–Ω–≤–∞—Ä—å', '–§–µ–≤—Ä–∞–ª—å', '–ú–∞—Ä—Ç', '–ê–ø—Ä–µ–ª—å', '–ú–∞–π', '–ò—é–Ω—å',
                '–ò—é–ª—å', '–ê–≤–≥—É—Å—Ç', '–°–µ–Ω—Ç—è–±—Ä—å', '–û–∫—Ç—è–±—Ä—å', '–ù–æ—è–±—Ä—å', '–î–µ–∫–∞–±—Ä—å'];
            document.getElementById('currentMonth').textContent = `${monthNames[month]} ${year}`;
        }

        function changeMonth(direction) {
            // –õ–æ–≥–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ—Å—è—Ü–∞
        }

    </script>
    
</body>
</html>
